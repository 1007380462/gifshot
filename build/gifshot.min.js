!function(e,t,i,o){var r,n,a;r={URL:e.URL||e.webkitURL||e.mozURL||e.msURL,getUserMedia:function(){var e=t.getUserMedia||t.webkitGetUserMedia||t.mozGetUserMedia||t.msGetUserMedia;return e?e.bind(t):e}(),isObject:function(e){return e?"[object Object]"===Object.prototype.toString.call(e):!1},isArray:function(e){return e?"isArray"in Array?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e):!1},isFunction:function(e){return e?"[object Function]"===Object.prototype.toString.call(e):!1},noop:function(){}},n=function(){return{videoElement:o,cameraStream:o,defaultVideoDimensions:{height:640,width:480},findVideoSize:function e(t){var i=t.videoElement,o=t.cameraStream,r=t.completedCallback;i&&(i.videoWidth>0&&i.videoHeight>0?(i.removeEventListener("loadeddata",this.findVideoSize),r({videoElement:i,cameraStream:o,videoWidth:i.videoWidth,videoHeight:i.videoHeight})):e.attempts<10?(e.attempts+=1,setTimeout(e,200)):r({videoElement:i,cameraStream:o,videoWidth:this.defaultVideoDimensions.width,videoHeight:this.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){e(new Error("Timed out while trying to start streaming"))},errorCallback:function(e){new Error("getUserMedia cannot access the camera",e)},startStreaming:function(e){var t,o=this,n=r.isFunction(e.error)?e.error:r.noop,a=r.isFunction(e.streamed)?e.streamed:r.noop,d=r.isFunction(e.completed)?e.completed:r.noop,c=i.createElement("video");c.autoplay=!0,r.getUserMedia({video:!0},function(e){a(),c.mozSrcObject?c.mozSrcObject=e:r.URL&&(c.src=r.URL.createObjectURL(e)),t=e,c.play(),c.addEventListener("loadeddata",function(){o.findVideoSize({videoElement:c,cameraStream:t,completedCallback:d})})},n)},startVideoStreaming:function(e,t){t=t||{};var i,n=this,a=t.timeout!==o?t.timeout:0;r.isFunction(r.getUserMedia)?(a>0&&(i=setTimeout(function(){n.onStreamingTimeout(e)},1e4)),this.startStreaming({error:n.errorCallback,streamed:function(){clearTimeout(i)},completed:function(t){var i=this.videoElement=t.videoElement,o=this.cameraStream=t.cameraStream,r=t.videoWidth,n=t.videoHeight;e(o,i,r,n)}})):e(new Error("Native device media streaming (getUserMedia) not supported in this browser."))},stopVideoStreaming:function(){var e=this.cameraStream,t=this.videoElement;e&&e.stop(),t&&(t.pause(),t.src=null,t=null)}}}(),a=function(){n.startVideoStreaming(function(e,t,i,o){console.log("cameraStream",e),console.log("videoElement",t),console.log("width",i),console.log("height",o)})}()}(window,window.navigator,document);